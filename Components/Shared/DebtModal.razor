@using Pennywise.Services.Interfaces
@using Pennywise.Model
@inject IJSRuntime JS

<div class="modal-backdrop">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Debt</h3>
                <button class="close-button" @onclick="OnCancel">&times;</button>
            </div>

            <EditForm Model="@Debt" OnValidSubmit="HandleSubmit">
                <DataAnnotationsValidator />

                <div class="form-field">
                    <label>Source of Debt</label>
                    <input type="text" class="input-field" @bind="Debt.Source" 
                           placeholder="Enter the source of debt" />
                    <ValidationMessage For="@(() => Debt.Source)" />
                </div>

                <div class="form-row">
                    <div class="form-field">
                        <label>Amount</label>
                        <input type="number" step="0.01" class="input-field" @bind="Debt.Amount" 
                               placeholder="$XX.XX" />
                        <ValidationMessage For="@(() => Debt.Amount)" />
                    </div>

                    <div class="form-field">
                        <label>Due Date</label>
                        <input type="date" class="input-field" @bind="Debt.DueDate" />
                        <ValidationMessage For="@(() => Debt.DueDate)" />
                    </div>
                </div>

                <div class="form-field">
                    <label>Notes (Optional)</label>
                    <textarea class="input-field" @bind="Debt.Notes" 
                             placeholder="Add any additional notes"></textarea>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-secondary" @onclick="OnCancel">Cancel</button>
                    <button type="submit" class="btn-primary">
                        Add Debt
                    </button>
                </div>
            </EditForm>
        </div>
    </div>
</div>

@code {
    [Parameter] public Debt Debt { get; set; } = new();
    [Parameter] public EventCallback<Debt> OnSave { get; set; }
    [Parameter] public EventCallback OnCancel { get; set; }

    private async Task HandleSubmit()
    {
        if (Debt.Amount <= 0)
        {
            await JS.InvokeVoidAsync("alert", "Amount must be greater than 0");
            return;
        }

        await OnSave.InvokeAsync(Debt);
    }
} 